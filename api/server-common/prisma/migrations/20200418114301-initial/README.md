# Migration `20200418114301-initial`

This migration has been generated by Salvatore at 4/18/2020, 11:43:01 AM.
You can check out the [state of the schema](schema.prisma) after the migration.

## Database Steps

```sql
CREATE TABLE "public"."User" (
    "anonymous" boolean  NOT NULL ,
    "createdAt" timestamp(3)  NOT NULL DEFAULT CURRENT_TIMESTAMP,
    "id" SERIAL,
    "password" text   ,
    "username" text  NOT NULL ,
    PRIMARY KEY ("id")
) 

CREATE TABLE "public"."ServerLeaderboardEntry" (
    "createdAt" timestamp(3)  NOT NULL DEFAULT CURRENT_TIMESTAMP,
    "id" SERIAL,
    "leaderboardEntryId" integer  NOT NULL ,
    "score" integer  NOT NULL ,
    "serverId" text  NOT NULL ,
    PRIMARY KEY ("id")
) 

CREATE TABLE "public"."GlobalLeaderboardEntry" (
    "createdAt" timestamp(3)  NOT NULL DEFAULT CURRENT_TIMESTAMP,
    "id" SERIAL,
    "leaderboardEntryId" integer  NOT NULL ,
    "score" integer  NOT NULL ,
    PRIMARY KEY ("id")
) 

CREATE TABLE "public"."LeaderboardEntry" (
    "aliveTime" integer  NOT NULL ,
    "calculatedScore" integer  NOT NULL ,
    "damageGiven" integer  NOT NULL ,
    "damageTaken" integer  NOT NULL ,
    "enemiesKilled" integer  NOT NULL ,
    "eventsParticipatedIn" integer  NOT NULL ,
    "id" SERIAL,
    "sessionId" text  NOT NULL ,
    "shotsFired" integer  NOT NULL ,
    "userId" integer  NOT NULL ,
    PRIMARY KEY ("id")
) 

CREATE TABLE "public"."Server" (
    "createdAt" timestamp(3)  NOT NULL DEFAULT CURRENT_TIMESTAMP,
    "id" SERIAL,
    "serverId" text  NOT NULL ,
    "updatedAt" timestamp(3)  NOT NULL DEFAULT CURRENT_TIMESTAMP,
    PRIMARY KEY ("id")
) 

CREATE TABLE "public"."ServerStat" (
    "Duration" integer  NOT NULL ,
    "boardWidth" integer  NOT NULL ,
    "bytesReceived" integer  NOT NULL ,
    "bytesSent" integer  NOT NULL ,
    "connections" integer  NOT NULL ,
    "createdAt" timestamp(3)  NOT NULL DEFAULT CURRENT_TIMESTAMP,
    "entities" integer  NOT NULL ,
    "entityGroupCount" text  NOT NULL ,
    "id" SERIAL,
    "memExternal" integer  NOT NULL ,
    "memHeapTotal" integer  NOT NULL ,
    "memHeapUsed" integer  NOT NULL ,
    "messages" integer  NOT NULL ,
    "serverId" integer  NOT NULL ,
    "spectators" integer  NOT NULL ,
    "tickIndex" integer  NOT NULL ,
    "totalBytesRecieved" integer  NOT NULL ,
    "totalBytesSent" integer  NOT NULL ,
    "users" integer  NOT NULL ,
    PRIMARY KEY ("id")
) 

ALTER TABLE "public"."ServerLeaderboardEntry" ADD FOREIGN KEY ("leaderboardEntryId")REFERENCES "public"."LeaderboardEntry"("id") ON DELETE CASCADE  ON UPDATE CASCADE

ALTER TABLE "public"."GlobalLeaderboardEntry" ADD FOREIGN KEY ("leaderboardEntryId")REFERENCES "public"."LeaderboardEntry"("id") ON DELETE CASCADE  ON UPDATE CASCADE

ALTER TABLE "public"."LeaderboardEntry" ADD FOREIGN KEY ("userId")REFERENCES "public"."User"("id") ON DELETE CASCADE  ON UPDATE CASCADE

ALTER TABLE "public"."ServerStat" ADD FOREIGN KEY ("serverId")REFERENCES "public"."Server"("id") ON DELETE CASCADE  ON UPDATE CASCADE
```

## Changes

```diff
diff --git schema.prisma schema.prisma
migration ..20200418114301-initial
--- datamodel.dml
+++ datamodel.dml
@@ -1,0 +1,77 @@
+datasource db {
+  provider = "postgresql"
+  url      = env("DATABASE_URL")
+}
+
+generator client {
+  provider = "prisma-client-js"
+}
+
+model User {
+  id        Int      @default(autoincrement()) @id
+  createdAt DateTime @default(now())
+  anonymous Boolean
+  username  String
+  password  String?
+}
+
+model ServerLeaderboardEntry {
+  id                 Int              @default(autoincrement()) @id
+  createdAt          DateTime         @default(now())
+  serverId           String
+  score              Int
+  leaderboardEntryId Int
+  leaderboardEntry   LeaderboardEntry @relation(fields: [leaderboardEntryId], references: [id])
+}
+
+model GlobalLeaderboardEntry {
+  id                 Int              @default(autoincrement()) @id
+  createdAt          DateTime         @default(now())
+  score              Int
+  leaderboardEntryId Int
+  leaderboardEntry   LeaderboardEntry @relation(fields: [leaderboardEntryId], references: [id])
+}
+
+model LeaderboardEntry {
+  id                   Int    @default(autoincrement()) @id
+  sessionId            String
+  userId               Int
+  user                 User   @relation(fields: [userId], references: [id])
+  aliveTime            Int
+  calculatedScore      Int
+  damageGiven          Int
+  damageTaken          Int
+  enemiesKilled        Int
+  eventsParticipatedIn Int
+  shotsFired           Int
+}
+
+model Server {
+  id        Int      @default(autoincrement()) @id
+  serverId  String
+  createdAt DateTime @default(now())
+  updatedAt DateTime @default(now())
+}
+
+model ServerStat {
+  id                 Int      @default(autoincrement()) @id
+  createdAt          DateTime @default(now())
+  serverId           Int
+  server             Server   @relation(fields: [serverId], references: [id])
+  tickIndex          Int
+  connections        Int
+  users              Int
+  spectators         Int
+  entities           Int
+  messages           Int
+  Duration           Int
+  bytesSent          Int
+  bytesReceived      Int
+  totalBytesSent     Int
+  totalBytesRecieved Int
+  boardWidth         Int
+  memHeapUsed        Int
+  memHeapTotal       Int
+  memExternal        Int
+  entityGroupCount   String
+}
```


